C   05/09/85 509061449  MEMBER NAME  CHROT    (S)           FORTRAN
      SUBROUTINE CHROT(E0,NTY,ICALL)
C
C
C=====ROUTINE TO RESET THE ROTATORS FOR USE AT A DIFFERENT ENERGY.
C=====PARAMETERS FROM K.STEFFENS E3 ROTATOR REPORT.
C
      IMPLICIT REAL*8 (A-H,O-Z)
#include "cnlist.for"
#include "clatic.for"
#include "csol.for"
C
C
      REAL*8  BRH1/'BRH1'/
      REAL*8  BRH2/'BRH2'/
      REAL*8  BRH3/'BRH3'/
      REAL*8  BRH4/'BRH4'/
      REAL*8  BRH5/'BRH5'/
      REAL*8  BRV1/'BRV1'/
      REAL*8  BRV2/'BRV2'/
      REAL*8  BRV3/'BRV3'/
      REAL*8  BIV1/'BIV1'/
      REAL*8  BIV2/'BIV2'/
      REAL*8  BIV3/'BIV3'/
      REAL*8 NU,NU0
C
C
      NUN=NUNT(NTY)
C=====NEW ROTATOR ENERGY  GEV
      NU=E0/0.440652
C
C=====GET APPROPRIATE INTERPOLATION PARAMETERS FOR VERTICAL BENDS.
      IF(NU.GE.61.5.AND.NU.LT.64.0) GO TO 1
      IF(NU.GE.64.0.AND.NU.LT.73.0) GO TO 2
      IF(NU.GE.73.0.AND.NU.LE.86.0) GO TO 3
      WRITE(6,103) NU
  103 FORMAT(' ',' TUNE ',F6.2,' OUT OF DESIGN RANGE OF ROTATOR')
      STOP
C=====CONSTANTS FOR SETTING VERTICAL BENDS IN RANGE  61.5<NU<64.
    1 AV=11.5701
      BV=0.4049833
      CV=-0.0791167
      NU0=62.5
      IV=1
      GO TO 12
C=====CONSTANTS FOR SETTING VERTICAL BENDS IN RANGE  64<NU<73.
    2 AV=12.3833
      BV=0.033425
      CV=-0.011625
      NU0=68.5
      IV=2
      GO TO 12
C=====CONSTANTS FOR SETTING VERTICAL BENDS IN RANGE  73.0<NU<86.
    3 AV=11.9468
      BV=-0.080625
      CV=-0.00233125
      NU0=78.5
      IV=3
C=====SET DELTA V3
   12 DNU=NU-NU0
      V3=AV+DNU*BV+DNU*DNU*CV
      V2=-V3*45/24.3
      V1=-V3-V2
      PV1=V1
      PV2=V2
      PV3=V3
      V3=V3*0.001D0/NUN
      V2=V2*0.001D0/NUN
      V1=V1*0.001D0/NUN
C
C=====GET APPROPRIATE INTERPOLATION PARAMETERS FOR HORIZONTAL BENDS.
      IF(NU.GE.61.5.AND.NU.LT.63.5) GO TO 4
      IF(NU.GE.63.5.AND.NU.LT.70.5) GO TO 5
      IF(NU.GE.70.5.AND.NU.LE.86.5) GO TO 6
      WRITE(6,103) E0
      STOP
C=====CONSTANTS FOR SETTING HORIZONTAL BENDS IN RANGE  61.5<NU<63.5
    4 AH=-4.10855
      BH= 48.3068
      CH=56.8106
      IH=1
      GO TO 13
C=====CONSTANTS FOR SETTING HORIZONTAL BENDS IN RANGE  63.5<NU<70.5
    5 AH=-9.9849
      BH=172.3982
      CH=50.3209
      IH=2
      GO TO 13
C=====CONSTANTS FOR SETTING HORIZONTAL BENDS IN RANGE  63.5<NU<86.5
    6 AH=-14.78275
      BH=419.68227
      CH=38.98936
      IH=3
C=====SET DELTA H4
   13 DH4=AH+BH/(NU-CH)
      H2=27.0076
      H40=6.2855
      HH4=(H40+DH4)*0.5
      H31=30.2076-3.2-2.D0*HH4-H2
      DH45=(30.2076-2.D0*HH4)*61.5948
      DH2=H2*16.0315
      DTOT=1497.35
      H3=(DH45-DTOT-DH2)/41.5315
      H1=H31-H3
      H5=HH4*0.001/NUN
      H4=HH4*0.001/NUN
      H3=H3*0.001/NUN
      H2=H2*0.001/NUN
      H1=H1*0.001/NUN
      PH1=H1*1000.*NUN
      PH2=H2*1000.*NUN
      PH3=H3*1000.*NUN
      PH4=H4*1000.*NUN
      PH5=H5*1000.*NUN
C
      IF(NAME(NTY).EQ.BRV1)XX(NTY)=V1
      IF(NAME(NTY).EQ.BRV2)XX(NTY)=V2
      IF(NAME(NTY).EQ.BRV3)XX(NTY)=V3
      IF(NAME(NTY).EQ.BIV1)XX(NTY)=-V1
      IF(NAME(NTY).EQ.BIV2)XX(NTY)=-V2
      IF(NAME(NTY).EQ.BIV3)XX(NTY)=-V3
      IF(NAME(NTY).EQ.BRH1)XX(NTY)=H1
      IF(NAME(NTY).EQ.BRH2)XX(NTY)=H2
      IF(NAME(NTY).EQ.BRH3)XX(NTY)=H3
      IF(NAME(NTY).EQ.BRH4)XX(NTY)=H4
      IF(NAME(NTY).EQ.BRH5)XX(NTY)=H5
      IF(ICALL.EQ.1)RETURN
      IF(NAME(NTY).EQ.BRV1)WRITE(6,101)NAME(NTY),PV1,IV
      IF(NAME(NTY).EQ.BRV2)WRITE(6,101)NAME(NTY),PV2,IV
      IF(NAME(NTY).EQ.BRV3)WRITE(6,101)NAME(NTY),PV3,IV
      IF(NAME(NTY).EQ.BIV1)WRITE(6,101)NAME(NTY),PV1,IV
      IF(NAME(NTY).EQ.BIV2)WRITE(6,101)NAME(NTY),PV2,IV
      IF(NAME(NTY).EQ.BIV3)WRITE(6,101)NAME(NTY),PV3,IV
      IF(NAME(NTY).EQ.BRH1)WRITE(6,101)NAME(NTY),PH1,IH
      IF(NAME(NTY).EQ.BRH2)WRITE(6,101)NAME(NTY),PH2,IH
      IF(NAME(NTY).EQ.BRH3)WRITE(6,101)NAME(NTY),PH3,IH
      IF(NAME(NTY).EQ.BRH4)WRITE(6,101)NAME(NTY),PH4,IH
      IF(NAME(NTY).EQ.BRH5)WRITE(6,101)NAME(NTY),PH5,IH
  101 FORMAT(' ',5X,A8,' ANGLE MRADS= ',F20.10,I5)
C
C
      RETURN
      END
